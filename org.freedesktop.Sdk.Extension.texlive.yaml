id: org.freedesktop.Sdk.Extension.texlive
branch: '19.08'
runtime: org.freedesktop.Sdk
build-extension: true
sdk: org.freedesktop.Sdk
runtime-version: '19.08'
appstream-compose: false
separate-locales: false
build-options:
  prefix: /usr/lib/sdk/texlive
  env:
    PATH: /usr/lib/sdk/texlive/bin:/usr/bin
modules:
- name: texlive
  buildsystem: autotools
  builddir: true
  config-opts:
  - --prefix=${FLATPAK_DEST}
  - --exec_prefix=${FLATPAK_DEST}
  - --bindir=${FLATPAK_DEST}/bin/${FLATPAK_ARCH}
  - --libdir=${FLATPAK_DEST}/lib/${FLATPAK_ARCH}
  - --includedir=${FLATPAK_DEST}/include
  - --datarootdir=${FLATPAK_DEST}/share
  - --mandir=${FLATPAK_DEST}/share/man
  - --infodir=${FLATPAK_DEST}/share/info
  - --with-banner-add='Flatpak'
  - --without-x # needs additonal dependencies
  - --disable-xetex # needs additonal dependencies
  - --disable-xindy # needs additonal dependencies
  sources:
  - type: archive
    url: https://ftp.tu-chemnitz.de/pub/tug/historic/systems/texlive/2019/texlive-20190410-source.tar.xz
    sha256: d2a29fef04e34dc3d2d2296c18995fc357aa7625e7a6bbf40fb92d83d3d0d7b5
# The texmf archive has only to be copied into the texlive directory and afterwards "mktexlsr", "fmtuitls-sys -all" and "mtxrun --generate" have to be executed to give a working texlive installation
#  - type: archive
#    url: https://ftp.tu-chemnitz.de/pub/tug/historic/systems/texlive/2019/texlive-20190410-texmf.tar.xz
#    sha256: c2ec974abc98b91995969e7871a0b56dbc80dd8508113ffcff6923e912c4c402
#    size: 2845806940
    
- name: appdata
  buildsystem: simple
  build-commands:
    - mkdir -p ${FLATPAK_DEST}/share/appdata
    - cp org.freedesktop.Sdk.Extension.texlive.appdata.xml ${FLATPAK_DEST}/share/appdata
    - appstream-compose  --basename=org.freedesktop.Sdk.Extension.texlive --prefix=${FLATPAK_DEST} --origin=flatpak org.freedesktop.Sdk.Extension.texlive
  sources:
  - type: file
    path: org.freedesktop.Sdk.Extension.texlive.appdata.xml

- name: scripts
  buildsystem: simple
  build-commands:
  - cp *.sh ${FLATPAK_DEST}
  sources:
  - type: script
    commands:
    - install -d /app
    - cp -ra ${FLATPAK_DEST}/* /app/
    dest-filename: install.sh
  - type: script
    commands:
    - export PATH=${FLATPAK_DEST}/bin/${FLATPAK_ARCH}:${FLATPAK_DEST}/bin:$PATH
    dest-filename: enable.sh
